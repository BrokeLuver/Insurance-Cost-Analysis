# Insurance-Cost-Analysis

![Python](https://img.shields.io/badge/Python-3.x-blue?logo=python)
![Scikit-learn](https://img.shields.io/badge/Scikit--learn-1.2+-orange?logo=scikit-learn)
![Status](https://img.shields.io/badge/Status-Completed-success)

**ВАЖНО** при просмотре проекта в Preview GitHub не отображаются важные графики, рекомендуется смотреть проект в среде **Google Colab**

(https://colab.research.google.com/drive/142Iv-hLRJf1H2r2tyc9TmWO9QCt886B2?usp=sharing)

Также, графики можно просмотреть во вкладке Issues данного репозитория

## Описание проекта

Данный проект представляет собой комплексный анализ данных, направленный на выявление ключевых факторов, влияющих на стоимость медицинской страховки для физических лиц. На основе данных строится прогнозная модель, позволяющая оценить потенциальные расходы клиента.

**Ключевые вопросы:**
- Как курение, возраст, ИМТ и другие факторы влияют на стоимость страховки?
- Какие факторы являются наиболее значимыми при ценообразовании?

## Исходные данные

Датасет `insurance.csv` (https://www.kaggle.com/datasets/varishabatool/data-set) содержит следующую информацию о клиентах:

|    Поле    |                 Описание                    |
|------------|---------------------------------------------|
|    `age`   | Возраст                                     |
|    `sex`   | Пол                                         |
|    `bmi`   | Индекс массы тела                           |
| `children` | Количество детей                            |
|  `smoker`  | Является ли клиент курильщиком              |
|  `region`  | Регион проживания                           |
|  `charges` | **Целевая переменная:** Стоимость страховки |

## Технологии и библиотеки

- **Python 3**
- **Анализ данных:** Pandas, NumPy
- **Визуализация:** Matplotlib, Seaborn, Plotly
- **Статистика:** SciPy
- **Машинное обучение:** Scikit-learn

## Основные этапы анализа

1.  **Предобработка данных:** Очистка и создание новых признаков (возрастные группы, категории ИМТ, уровень расходов).
2.  **Разведочный анализ (EDA):** Визуализация распределений, проверка корреляций, анализ взаимосвязей.
3.  **Проверка гипотез:** Статистическая проверка влияния курения, возраста, ИМТ и количества детей на стоимость.
4.  **Машинное обучение:**
    - Подготовка данных (кодирование категориальных признаков, масштабирование).
    - Обучение моделей **Линейной регрессии** и **Случайного леса**.
    - Оценка качества моделей и анализ важности признаков.
  
## Ключевые выводы

### Результаты проверки гипотез

1.  **Курение** — самый сильный фактор. Страховка для курильщиков в среднем **в 4.85 раза дороже** (p-value < 0.0001).
2.  **Возраст** — умеренная положительная корреляция (0.30). С возрастом стоимость страховки растет.
3.  **ИМТ** — слабая положительная связь (0.20). Значительное влияние оказывает в комбинации с курением.
4.  **Количество детей** — статистически подтверждено, но практическое влияние незначительно.

### Результаты моделирования

Лучшие результаты показала модель **Random Forest Regressor**:

- **MAE:** ~2520.15
- **RMSE:** ~4572.57
- **R^2:** ~0.8653

Модель объясняет 86.5% дисперсии целевой переменной, что является приемлемым результатом.

## Рекомендации для бизнеса

- **Основные факторы ценообразования:** Модель должна в первую очередь учитывать **статус курения** и **возраст** клиента.
- **Факторы риска:** Высокий **ИМТ** должен быть весомым фактором для клиентов из группы риска (курящих).
- **Второстепенные факторы:** Количество детей, пол и регион могут быть использованы для тонкой настройки тарифов, но не должны лежать в их основе.
